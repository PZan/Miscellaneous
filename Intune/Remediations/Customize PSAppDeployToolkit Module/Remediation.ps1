#region: AppIcon.png-base64
$AppIconBase64 = "iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAFxEAABcRAcom8z8AAARBSURBVHhe7Zs9TutAFIUnbxkIIZSwDKjZAAV0qZBgAdBQ0oCoQaKiChQsAChoYBlAgRDbyJszzLVu/BLHcSIdP3I+yfLPjMeT+41/4pt0hpEgaPzJc0FCAshIABkJICMBZCSAjASQkQAyEkBGAshIABkJICMBZCSAjASQkQAyEkBGAshIABkJICMBZCSAjASQkQAyEkBGAshIABkJICMBZCSAjASQkQAyVAGdTifc3d3ltR82NjbC+fl5XlsC8A8ZFmdnZ8Ner5fXhsPb21v8WyevLQf0T4uAI/AAMiAFvL+/pzKbtre303aAOn4doM7Ly0taRpnJxIS22gr9HhADFU5OTopL0dHRUfj4+AhRRiqLfUzT29tbODw8THXqsLe3F2Lg077dbjdvbR90Abu7u2mOgJ2enqbl+/v7EEdxUQZQ9vT0lNemE8+SVgfeaMVTEIKLEe8DXg7e6upqGtG/jdY+huIy5Pn6+kqSwNraWpr/BlopYGdnJzw+Po48ouI+sb+/n5ZxNqDcJM1yb2gbrRSAy098okn3BXxXwITg4wYNNjc3w8HBQTojULa+vl6cHf8b+qc8mdbeA5YFCSAjAWQkgIwEkJEAMhJARgLI1BLw+vqavnEu+is/XjUgA7bM1BIwGAzSV/+rq6u8RSwMvIqYBqohq9Tr9YrslYEyZKIwt8nAdtvHynwmC9tR7vHt+GNhP1/ms1xW18rKbXriQCoyalbfH2daW+V+YLJMXBOmCvBBmpQKxGSg3OqYGL8P1i3t6NsGWLYyYGW+TYA6/phYrmrHAwGob0G3YJvQqrYw92W+naZMFYAPbh1AJ31nAdb9CLCgl5cNtGXB9ALG1QXjjgn8cf0ywDEQ6HFge7kMfbBAVrVV3tfHpimV9wC8b8d7d7yfB3hNHDsbLi4u0vo4VlZW8tJ4qpIpaHsS5QwZ6iJJM4lyQqeKaQ8C1hZee/u0KGIzb3KoUgByswAf1t7Lx5FYeTP+/v7OS+P5/PzMS/+CtidRDijqIjGzCJDwrwuOa7GIZ8NIGrUJlQKur69TcjueKcVkQfLZqn6/n5d+8rvomMc/vh4fH4/UN5BkAf5HWRiZGPnxVB9pA3UwKGyfKtBPBMsLxADCozVAOT5TnUA+Pz+P/FLj8vIylzRnogB0EB2zLJRhAbm5uclbQspW2ajAaCp3DKdunVGD40GQ1bVjPDw8pHZtOwbGLKO2DPqAQYC2kHWL1/xcUg0+l8/SYZr7V3zR5FygCX/T8mD7Ag6xUHATxdSEeNaNPPXEAZM+H+ZNqfVFTPyAM9Tfd+x+V35AmAUJmAFcqra2torLD5YhZR6UlCejM4CMBJCRADISQEYCyEgAGQkgIwFkJICMBJCRADISQEYCyEgAGQkgIwFkJICMBJCRADISQEYCyEgAGQkgIwFkJICMBJCRADISQEYCyEgAGQkgIwFUQvgLzavFWoqwmXUAAAAASUVORK5CYII="
#endregion

#region Banner.Classic.png-Base64
$BannerClassicBase64 = "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"
#endregion

try {
    # Obtain latest installed PSAppDeployToolkit module
    $LatestInstalledModule = Get-Module PSAppDeployToolkit -ListAvailable -ErrorAction Stop | Sort-Object Version | Select-Object -Last 1
}
catch {
    Write-Output "Failed to obtain PSAppDeployToolkit module."
    Exit 1603
}

if ( $LatestInstalledModule ) {
    # Define path to assets directory
    $AssetsDir = Join-Path -Path ($LatestInstalledModule.Path | Split-Path -Parent) -ChildPath "Assets"
    
    # Write AppIcon Base64 string to png file in Assets directory
    $AppIconBytes = [Convert]::FromBase64String($AppIconBase64)
    $AppIconDestination = Join-Path -Path $AssetsDir -ChildPath "AppIcon.png" -ErrorAction Ignore
    $null = [IO.File]::WriteAllBytes($AppIconDestination, $AppIconBytes)


    # Write Banner Classic Base64 string to png file in Assets directory
    $BannerClassicBytes = [Convert]::FromBase64String($BannerClassicBase64)
    $BannerClassicDestination = Join-Path -Path $AssetsDir -ChildPath "Banner.Classic.png" -ErrorAction Ignore
    $null = [IO.File]::WriteAllBytes($BannerClassicDestination, $BannerClassicBytes)
}